<!DOCTYPE html>
<html>
<head>
  <title>TSP API Tester</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input, textarea { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
    button { margin-top: 20px; padding: 12px 24px; background: #4285f4; color: white; border: none; cursor: pointer; font-size: 16px; }
    button:hover { background: #3367d6; }
    #result { margin-top: 20px; padding: 15px; border-radius: 5px; white-space: pre-wrap; font-family: monospace; }
    .success { background: #d4edda; border: 1px solid #28a745; }
    .error { background: #f8d7da; border: 1px solid #dc3545; }
    .pending { background: #fff3cd; border: 1px solid #ffc107; }
  </style>
</head>
<body>
  <h1>ðŸ¥ª TSP Event API Tester</h1>
  
  <label>Date:</label>
  <input type="date" id="date">
  
  <label>Group Name:</label>
  <input type="text" id="groupName" value="TEST GROUP - DELETE ME">
  
  <label>Start Time:</label>
  <input type="text" id="startTime" value="10:00 AM">
  
  <label>End Time:</label>
  <input type="text" id="endTime" value="12:00 PM">
  
  <label>Pickup Time:</label>
  <input type="text" id="pickupTime" value="9:30 AM">
  
  <label>Details:</label>
  <textarea id="details" rows="2">API test - safe to delete</textarea>
  
  <label>Estimate:</label>
  <input type="number" id="estimate" value="100">
  
  <button onclick="testApi()">ðŸš€ Send Test Event</button>
  
  <div id="result"></div>

  <script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbzR0WlK4UoHYrPv0L7EzIfOPyhspehlIoWTj9yKsUmWLu-2QfZWSzCNOHFuPuxBZS0jdg/exec';
    const API_KEY = 'f47ac10b-58cc-4372-a567-0e02b2c3d479';
    
    async function testApi() {
      const resultDiv = document.getElementById('result');
      resultDiv.textContent = 'Sending request...';
      resultDiv.className = 'pending';
      
      const payload = {
        apiKey: API_KEY,
        date: document.getElementById('date').value,
        groupName: document.getElementById('groupName').value.trim(),
        startTime: document.getElementById('startTime').value.trim(),
        endTime: document.getElementById('endTime').value.trim(),
        pickupTime: document.getElementById('pickupTime').value.trim(),
        details: document.getElementById('details').value.trim(),
        estimate: document.getElementById('estimate').value.trim()
      };
      
      console.log('Sending:', payload);
      
      try {
        const response = await fetch(API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'text/plain' },
          body: JSON.stringify(payload)
        });
        
        const text = await response.text();
        console.log('Raw response:', text);
        
        let data;
        try {
          data = JSON.parse(text);
        } catch (e) {
          resultDiv.textContent = 'Response (not JSON):\n\n' + text;
          resultDiv.className = 'error';
          return;
        }
        
        resultDiv.textContent = JSON.stringify(data, null, 2);
        resultDiv.className = data.success ? 'success' : 'error';
        
      } catch (error) {
        resultDiv.textContent = 'Network Error:\n\n' + error.message + '\n\nCheck console for details.';
        resultDiv.className = 'error';
        console.error('Full error:', error);
      }
    }
  </script>
</body>
</html>